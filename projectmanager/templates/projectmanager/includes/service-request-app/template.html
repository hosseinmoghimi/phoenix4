{% load to_persian_date %}
{% load to_price %}
<div class="card mb-3" id="service-request-app">
    <div class="card-body">


        <h6 class="text-secondary">
            پروژه :
            <a href="{{service_request.project.get_absolute_url}}">

                {{service_request.project.title}}
            </a>
        </h6>

        <h5 class="text-right">
            سرویس :
            <a href="{{service_request.service.get_absolute_url}}">

                {{service_request.service.title}}
            </a>
            <span class="badge badge-{{service_request.get_status_color}}">{{service_request.status}}</span>
      

        </h5>




        <p>


            تعداد : {{service_request.quantity}}
            <small>
                {{service_request.unit_name}}
            </small>
            *


            {{service_request.unit_price|to_price_pure}} =
            <strong>
                {{service_request.line_total|to_price}}
            </strong>

        </p>
        <p>
            <small>

                {{service_request.line_total|to_horuf}} {{CURRENCY}}
            </small>

        </p>
        <table class="table">
            <thead>
                <th>
                    امضا کننده
                </th>
                <th>
                    زمان
                </th>
                <th>
                    وضعیت
                </th>
            </thead>
            <tbody>
                {% for signature in service_request.servicerequestsignature_set.all %}
                <tr>
                    <td colspan="3">

                    </td>
                </tr>
                <tr>
                    <td colspan="3">

                    </td>
                </tr>
                {% if signature.description %}

                <tr>
                    <td colspan="3">
                        <small class="text-{{signature.get_status_color}}">

                            {{signature.description}}
                        </small>
                    </td>
                </tr>
                {% endif %}
                <tr>
                    <td>
                        <a href="{{signature.profile.get_absolute_url}}">
                            <img src="{{signature.profile.image}}" class="rounded-circle mr-3" width=48 alt="">
                            {{signature.profile.name}}
                        </a>
                    </td>
                    <td>
                        <small>

                            {{signature.date_added|to_persian_datetime|safe}}
                        </small>
                    </td>
                    <td>
                        {{signature.get_status_tag|safe}}
                        {{signature.get_edit_btn|safe}}

                    </td>
                </tr>
                {% endfor %}




                <template v-for="signature in signatures">
                    <tr>
                        
                        <td colspan="3">

                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">

                        </td>
                    </tr>

                    <tr v-if="signature.description">
                        <td colspan="3">
                            <small :class="'text-'+signature.get_status_color" v-text="signature.description">
                            </small>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <a :href="signature.profile.get_absolute_url">
                                <img :src="signature.profile.image" class="rounded-circle mr-3" width=48 alt="">
                                <span v-text="signature.profile.name"></span>
                            </a>
                        </td>
                        <td>
                            <small v-text="signature.persian_date_added">
                            </small>
                        </td>
                        <td>
                            <span :class="'badge badge-'+signature.get_status_color" v-text="signature.status"></span>
                        </td>
                    </tr>
                </template>
            </tbody>
        </table>
        <div>


        </div>
    </div>
    <div class="card-footer">
        <form @submit.prevent="add_signature()">
            <div class="row">
                <div class="col-md-5">
                    <input type="text" v-model="add_signature_form_description" placeholder="پاراف"
                        class="form-control farsi">
                </div>



                <div class="col-md-4">
                    <select v-model="add_signature_form_status" id="">
                        {% for signature_status in signature_statuses %}
                        <option value="{{signature_status}}" class="farsi">{{signature_status}}</option>

                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-2">
                   
                    <button type="submit" class="btn btn-success">
                        <i class="material-icons">
                            add
                        </i>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>