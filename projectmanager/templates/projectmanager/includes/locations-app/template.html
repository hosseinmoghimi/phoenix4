<!-- موقعیت در نقشه -->

{% load static %}

<div id="accordion">


    <div class="card card-stats" id="locations-app">
        <div class="card-header card-header-warning card-header-icon" id="headingLocations">

            <h3 class="card-title text-center">
                <button class="btn btn-link" data-toggle="collapse" data-target="#collapseseLocations"
                    aria-expanded="true" aria-controls="collapseseLocations">
                    موقعیت در نقشه
                </button>

            </h3>
        </div>

        <div id="collapseseLocations" class="collapse {% if locations %}show{% endif %}"
            aria-labelledby="headingLocations" data-parent="#accordion">
            <div class="card-body ">



                {% for location in locations %}
                <div class="mb-5">
                    <h4 class="mb-2">
                        <a href="{{location.get_absolute_url}}">

                            <span>{{location.title}}</span>
                        </a>
                        <a target="_blank" href="{{location.get_edit_url}}">
                            <i class="material-icons">
                                settings
                            </i>
                        </a>
                    </h4>
                    <div>
                        {{location.location|safe}}
                    </div>
                </div>
                {% endfor %}

                <div v-for="location in locations" class="mb-5">
                    <h4 class="mb-2">
                        <a :href="location.get_absolute_url">

                            <span v-text="location.title"></span>
                        </a>
                        <a target="_blank" :href="location.get_edit_url">
                            <i class="material-icons">
                                settings
                            </i>
                        </a>
                    </h4>
                    <div v-html="location.location">

                    </div>
                </div>

                {% if add_existing_location_form %}
                <form v-if="show_add_location_form" @submit.prevent="add_existing_location">
                    <h5>
                        انتخاب موقعیت مکانی از قبل موجود
                    </h5>
                    <select name="" class="form-control" v-model="location_id">
                        {% for location in all_locations %}

                        <option value="{{location.id}}">{{location.title}}</option>
                        {% endfor %}
                    </select>
                    <button @click="show_add_location_form=false" v-if="show_add_location_form"
                        class="btn btn-secondary">
                        انصراف
                    </button>

                    <button v-if="!waiting" v-if="new_location" class="btn btn-success btn-round"
                        type="submit">افزودن</button> <br>

                   
                        
                </form>

                {% endif %}
                {% if add_location_form %}
                <form v-if="show_add_location_form" @submit.prevent="add_location">
                    <h5>
                        افزودن موقعیت مکانی جدید
                    </h5>
                    <input placeholder="عنوان نقطه" required type="text" class="form-control"
                        v-model="new_location_title">
                    <input placeholder="موقعیت" required type="text" class="form-control" v-model="new_location">

                    <img v-if="waiting" width="32" src="{% static 'leo/img/loading.gif' %}" alt="">

                    <button @click="show_add_location_form=false" v-if="show_add_location_form"
                        class="btn btn-secondary">
                        انصراف
                    </button>

                    <button v-if="!waiting" v-if="new_location" class="btn btn-success btn-round"
                        type="submit">افزودن</button> <br>
                   
  <p>

                    <a target="_blank" href="https://www.google.com/maps" class="farsi">
                        <i class="material-icons">map</map></i>
                        استفاده از نقشه</a>
                </p>
                </form>
              

                <p>

                    <button @click="show_add_location_form=true" v-if="!show_add_location_form" class="btn btn-success">
                        <i class="material-icons">
                            add
                        </i>
                    </button>
                </p>
               
                {% endif %}


            </div>
            <div class="card-footer text-right farsi">
                <a target="_blank" href="{% url 'help:help' app_name='projectmanager' template='add_location' %}">
                    <i class="material-icons" aria-hidden="true">help</i>
                    راهنما</a>
            </div>
        </div>
    </div>
</div>