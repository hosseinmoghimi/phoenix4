{% extends "phoenix/wide-layout.html" %}
{% load to_persian_date %}
{% load to_price %}
{% load static %}
{% block content %}



<div class="row mt-3">
    <div class="col-md-12">
        <div class="text-center farsi">
            <a href="{{financial_account.get_absolute_url}}">{{financial_account.title}}</a>
        </div>
    </div>
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">

                <h4 class="text-center">
                    گزارش
                </h4>
            </div>
            <div class="card-body">
                <div class="farsi text-center">
                    گزارش سالانه
                    <span class="mx-3">
                        {{year}}
                    </span>

                </div>
                <div class="table-responsive">

                    <table class="table table-striped">
                        <thead>
                            <th>

                            </th>
                            <th>
                                سود فروش
                            </th>
                            <th>
                                حقوق
                            </th>
                            <th>
                                هزینه
                            </th>
                            <th>
                                فروش خدمات
                            </th>
                            <th>
                                خرید خدمات
                            </th>
                            <th>
                                هزینه حمل
                            </th>
                            <th>
                                تخفیف
                            </th>
                        </thead>
                        <tbody>
                            {% for rep_item in rep %}
                            <tr>
                                <td>
                                    {{rep_item.month_name}}
                                </td>
                                <td>
                                    {{rep_item.sell_benefit|to_price}}

                                </td>
                                <td>

                                    {{rep_item.wage|to_price}}
                                </td>
                                <td>

                                    {{rep_item.cost|to_price}}
                                </td>
                                <td>

                                    {{rep_item.sell_service|to_price}}
                                </td>
                                <td>
                                    {{rep_item.buy_service|to_price}}
                                </td>

                                <td>
                                    {{rep_item.ship_fee|to_price}}
                                </td>
                                <td>
                                    {{rep_item.discount|to_price}}
                                </td>
                            </tr>
                            {% endfor %}



                        </tbody>

                    </table>
                </div>

            </div>
        </div>
    </div>
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                <div class=" farsi text-right">
                    <span class="text-info">
                        سود حاصل از فروش
                    </span>
                    <span class="text-danger">

                        هزینه ها
                    </span>

                    <span class="text-success">
                        حقوق </span>

                </div>
                <div class="text-center">

                    <canvas id="report-linear-chart-1" style="width:100%;"></canvas>

                </div>


            </div>

        </div>
    </div>



    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <div class=" farsi text-right">

                    <span class="text-success">
                        خدمات </span>

                </div>
                <div class="text-center">

                    <canvas id="report-linear-chart-service" style="width:100%;max-width:800px"></canvas>

                </div>


            </div>

        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <div class=" farsi text-right">

                    <span class="text-success">
                        مالیات </span>

                </div>
                <div class="text-center">

                    <canvas id="report-linear-chart-tax" style="width:100%;max-width:800px"></canvas>

                </div>


            </div>

        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <div class=" farsi text-right">

                    <span class="text-success">
                        حقوق </span>

                </div>
                <div class="text-center">

                    <canvas id="report-linear-chart-wage" style="width:100%;max-width:800px"></canvas>

                </div>


            </div>

        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <div class=" farsi text-right">

                    <span class="text-danger">
                        هزینه ها </span>

                </div>
                <div class="text-center">

                    <canvas id="report-linear-chart-cost" style="width:100%;max-width:800px"></canvas>

                </div>


            </div>

        </div>
    </div>


</div>


{% endblock content %}

{% block script %}
<script src="{% static 'persian/moment.js' %}"></script>
<script src="{% static 'persian/moment-jalaali.js' %}"></script>
<script src="{% static 'persian/vue-persian-datetime-picker-browser.js' %}"></script>
<script src="{% static 'charts/Chart.min.js' %}"></script>

<script>
    let financial_account_id = parseInt("{{financial_account.id}}")
 
</script>


<script>

    $(document).ready(() => {
        drawVoltageLinearChart()
    })

    let report_data = JSON.parse(`{{rep_s|escapejs}}`)
    let chart_data_cost = []
    let chart_data_wage = []
    let chart_data_tax = []
    let chart_data_sell_service = []
    let chart_data_buy_service = []
    let chart_data_sell_benefit = []
    report_data.forEach(month => {
        chart_data_cost.push(month.cost)
        chart_data_wage.push(month.wage)
        chart_data_sell_service.push(month.sell_service)
        chart_data_tax.push(month.tax)
        chart_data_buy_service.push(month.buy_service)
        chart_data_sell_benefit.push(month.sell_benefit)
    });
    var xValues = ["فروردین", "اردیبهشت", "خرداد", "تیر", "مرداد", "شهریور", "مهر", "آبان", "آذر", "دی", "بهمن", "اسفند"];
    function drawVoltageLinearChart() {

        new Chart("report-linear-chart-1", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                    data: chart_data_cost,
                    borderColor: "red",
                    fill: false
                }, {
                    data: chart_data_wage,
                    borderColor: "green",
                    fill: false
                }, {
                    data: chart_data_sell_benefit,
                    borderColor: "blue",
                    fill: false
                }]
            },
            options: {
                legend: { display: false }
            }
        })

        new Chart("report-linear-chart-service", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                    data: chart_data_sell_service,
                    borderColor: "green",
                    fill: false
                }, {
                    data: chart_data_buy_service,
                    borderColor: "red",
                    fill: false
                }]
            },
            options: {
                legend: { display: false }
            }
        })



        new Chart("report-linear-chart-service", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                    data: chart_data_sell_service,
                    borderColor: "green",
                    fill: false
                }, {
                    data: chart_data_buy_service,
                    borderColor: "red",
                    fill: false
                }]
            },
            options: {
                legend: { display: false }
            }
        })



        new Chart("report-linear-chart-tax", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                    data: chart_data_tax,
                    borderColor: "red",
                    fill: false
                }]
            },
            options: {
                legend: { display: false }
            }
        })




        new Chart("report-linear-chart-wage", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                    data: chart_data_wage,
                    borderColor: "blue",
                    fill: false
                }]
            },
            options: {
                legend: { display: false }
            }
        })


        new Chart("report-linear-chart-cost", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                    data: chart_data_cost,
                    borderColor: "red",
                    fill: false
                }]
            },
            options: {
                legend: { display: false }
            }
        })




    }

</script>



<script>

</script>

<!-- <script src="{% static 'charts/chart.js' %}"></script> -->

<script>

    // const data = {
    //     labels: [
    //         'Red',
    //         'Blue',
    //         'Yellow'
    //     ],
    //     datasets: [{
    //         label: 'My First Dataset',
    //         data: [300, 50, 100],
    //         backgroundColor: [
    //             'rgb(255, 99, 132)',
    //             'rgb(54, 162, 235)',
    //             'rgb(255, 205, 86)'
    //         ],
    //         hoverOffset: 4
    //     }]
    // };

    // const config = {
    //     type: 'pie',
    //     data: data,
    // };


</script>

{% endblock script %}